{% extends 'base.html.twig' %}
{% block title %}
  School Assessments View
{% endblock %}

{% block stylesheet %}
<style>

</style>
{% endblock %}

{% block body %}
  <div class="container" id="view_container">
    <a href="{{ path('assessment_result_create', {'school_session_id': school_session_id}) }}">Add Student Result</a>
    <table border="0">
      <thead>
        <tr>
          <th>Assessment Result Student</th>

          {% set assessmentWorthTotal = 0 %}
          {% for assessment_session in assessment_sessions %}
            <th>
              {% for assessment_type in assessment_types %}
                {% if assessment_type.id == assessment_session.assessmentId %}
                  {% set assessmentWorthTotal = assessmentWorthTotal + assessment_type.assessmentWorth %}
                  {{ assessment_type.assessmentName }}  {{ '('~ assessment_type.assessmentWorth ~'%)'}}
                {% endif %}
              {% endfor %}
            </th>
          {% endfor %}

          <th>
            Total ( {{ assessmentWorthTotal }} %)
          </th>

          <th>
            Grade
          </th>
        </tr>
      </thead>

      <tbody>
        {% for student in students %}
          <tr>
            <td>
              {% for student in students %}
                {{ student.firstNameEn ~ ' ' ~ student.middleNameEn ~ ' ' ~ student.lastNameEn }}
              {% endfor %}
            </td>

            {% set assessmentResultTotal = 0 %}
            {% for assessment_session in assessment_sessions %}
              <td>
                {% for assessment_result in assessment_results %}
                  {% if student.id == assessment_result.studentId and assessment_result.assessmentId == assessment_session.id %}
                    {{ assessment_result.resultValue }}
                    {% set assessmentResultTotal = assessmentResultTotal + assessment_result.resultValue  %}
                  {% endif %}
                {% endfor %}
              </td>
            {% endfor %}

            <td>
              {{ assessmentResultTotal }}
            </td>

            <td>
              {% for grade in grades %}
                {% if assessmentResultTotal >= grade.startPoint and assessmentResultTotal <= grade.endPoint %}
                  {{ grade.grade }}
                {% endif %}
              {% endfor %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
